(function(){"use strict";(()=>{const o=async()=>{const a="formychat_ip_data",r=n=>{delete n.success,window.formychat_ip=n,window.dispatchEvent(new CustomEvent("formychat_ip_loaded",{detail:n}))};try{const n=localStorage.getItem(a);if(n){const{timestamp:l,data:s}=JSON.parse(n);if(Date.now()-l<864e5)return r(s),s}const m=await fetch("https://ipwhois.app/json/");if(!m.ok)throw new Error("Failed to fetch IP data");const d=await m.json();if(!d||typeof d!="object")throw new Error("Invalid IP data");return localStorage.setItem(a,JSON.stringify({timestamp:Date.now(),data:d})),r(d),d}catch{return window.formychat_ip=null,null}};document.addEventListener("DOMContentLoaded",o),window.addEventListener("formychat_ip_loaded",a=>{var i,r;window.formychat_country_code=((r=(i=a.detail)==null?void 0:i.country_phone)==null?void 0:r.replace("+",""))||"44"})})(),(()=>{const o=document.querySelector(".formychat-dropdown");if(!o)return;const a=o.querySelector(".formychat-dropdown-placeholder"),i=o.querySelector(".formychat-dropdown-content-search"),r=o.querySelector(".formychat-dropdown-input"),n=()=>{document.addEventListener("click",e=>{if(!e.target.closest(".formychat-dropdown"))return l();if(e.target.closest(".formychat-dropdown-placeholder"))return m(e);if(e.target.closest(".formychat-dropdown-content-item")||e.target.classList.contains("formychat-dropdown-content-item"))return s(e)}),document.addEventListener("keyup",e=>{if(e.target.closest(".formychat-dropdown")){if(e.target.closest(".formychat-dropdown-content-search")){u(e.target.value.toLowerCase().trim());return}if(e.key==="Escape"){l();return}}});const t=o.querySelector(".formychat-dropdown-content-item.selected");t&&s({target:t}),window.addEventListener("formychat_ip_loaded",e=>{console.log("formychat_ip_loaded",e.detail)})};window.addEventListener("DOMContentLoaded",n);const m=t=>{if(t.preventDefault(),o.classList.contains("open"))return l();d()},d=()=>{o.classList.add("active"),i.focus();const t=o.querySelector(".formychat-dropdown-content-item.selected");t&&t.scrollIntoView({behavior:"smooth",block:"center"})},l=()=>{o.classList.remove("active")},s=t=>{o.querySelectorAll(".formychat-dropdown-content-item").forEach(c=>{c.classList.remove("selected")}),t.target.classList.add("selected"),a&&(a.querySelector("span").textContent=t.target.dataset.placeholder),r.value=t.target.dataset.value,i.value="",u(),l()},u=(t="")=>{o.querySelectorAll(".formychat-dropdown-content-item").forEach(c=>{let f=!t||t.length===0;t&&t.length&&(f=t.length===0||c.dataset.tags.toLowerCase().includes(t)),c.style.display=f?"block":"none"})};if(!r.value||r.value.length===0)if(window.formychat_country_code){const t=o.querySelectorAll(".formychat-dropdown-content-item"),e=Array.from(t).find(c=>c.dataset.value===window.formychat_country_code);e&&s({target:e})}else window.addEventListener("formychat_ip_loaded",t=>{var y,h;const e=((h=(y=t.detail)==null?void 0:y.country_phone)==null?void 0:h.replace("+",""))||"44",c=o.querySelectorAll(".formychat-dropdown-content-item"),f=Array.from(c).find(p=>p.dataset.value===e);f&&s({target:f})})})()})();
//# sourceMappingURL=admin.common.js.map
